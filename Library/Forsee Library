-- Forsee Library - UPDATED with Startup Config System

local lib = {RainbowColorValue = 0, HueSelectionPosition = 0}
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local LocalPlayer = game:GetService("Players").LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local PresetColor = Color3.fromRGB(44, 120, 224)
local CloseBind = Enum.KeyCode.RightControl

-- Config saving system with persistent storage
local HttpService = game:GetService("HttpService")
local ConfigFolder = "Forsee Library"
local ConfigSubfolder = "Default"
local ConfigElements = {}
local CurrentConfigName = ""
local StartupSettingsFile = ConfigFolder .. "/startup_settings.json" -- New file for startup settings

-- Global element ID counter
local globalElementIdCounter = 0

-- Notification management
local CurrentNotification = nil

-- Track UI state
local uitoggled = false
local uiElementStates = {}

-- Create config folder if it doesn't exist
if not isfolder(ConfigFolder) then
    makefolder(ConfigFolder)
end

-- Function to get full config path
local function GetFullConfigPath()
    local path = ConfigFolder .. "/" .. ConfigSubfolder
    if not isfolder(path) then
        makefolder(path)
    end
    return path
end

function lib:SetConfigFolder(name)
    ConfigSubfolder = name or "Default"
end

local function SaveConfig(name)
    if not name or name == "" then
        return false, "Config name cannot be empty"
    end
    local configData = {
        PresetColor = {R = PresetColor.R, G = PresetColor.G, B = PresetColor.B},
        CloseBind = CloseBind.Name,
        Elements = {}
    }
    for id, element in pairs(ConfigElements) do
        if element.Type == "Toggle" then configData.Elements[id] = {Type = "Toggle", Value = element.Value}
        elseif element.Type == "Slider" then configData.Elements[id] = {Type = "Slider", Value = element.Value}
        elseif element.Type == "Dropdown" then configData.Elements[id] = {Type = "Dropdown", Value = element.Value}
        elseif element.Type == "Textbox" then configData.Elements[id] = {Type = "Textbox", Value = element.Value}
        elseif element.Type == "Bind" then configData.Elements[id] = {Type = "Bind", Value = element.Value} end
    end
    local success, err = pcall(function()
        writefile(GetFullConfigPath() .. "/" .. name .. ".json", HttpService:JSONEncode(configData))
    end)
    if success then return true, "Config '" .. name .. "' saved!" else return false, "Failed to save: " .. tostring(err) end
end

local function LoadConfig(name)
    if not name or name == "" then return false, "Config name cannot be empty" end
    local filePath = GetFullConfigPath() .. "/" .. name .. ".json"
    if not isfile(filePath) then return false, "Config '" .. name .. "' not found" end
    local success, result = pcall(function() return HttpService:JSONDecode(readfile(filePath)) end)
    if not success then return false, "Failed to load config: " .. tostring(result) end
    local config = result
    if config.PresetColor then PresetColor = Color3.new(config.PresetColor.R, config.PresetColor.G, config.PresetColor.B) if lib.ChangePresetColor then lib:ChangePresetColor(PresetColor) end end
    if config.CloseBind then for _, kc in pairs(Enum.KeyCode:GetEnumItems()) do if kc.Name == config.CloseBind then CloseBind = kc break end end end
    if config.Elements then for id, data in pairs(config.Elements) do if ConfigElements[id] and ConfigElements[id].LoadValue then ConfigElements[id].LoadValue(data.Value) end end end
    return true, "Config '" .. name .. "' loaded!"
end

local function DeleteConfig(name)
    if not name or name == "" then return false, "Config name cannot be empty" end
    local filePath = GetFullConfigPath() .. "/" .. name .. ".json"
    if not isfile(filePath) then return false, "Config '" .. name .. "' not found" end
    local success, err = pcall(function() delfile(filePath) end)
    if success then return true, "Config '" .. name .. "' deleted!" else return false, "Failed to delete: " .. tostring(err) end
end

local function GetAllConfigs()
    local configs = {}
    local success, files = pcall(listfiles, GetFullConfigPath())
    if success then for _, file in pairs(files) do local fileName = file:match("([^/]+)%.json$") if fileName then table.insert(configs, fileName) end end end
    return configs
end

-- NEW: Functions to handle startup config settings
local function LoadStartupSettings()
    if isfile(StartupSettingsFile) then
        local success, data = pcall(function()
            return HttpService:JSONDecode(readfile(StartupSettingsFile))
        end)
        if success and type(data) == "table" then
            return data
        end
    end
    -- Return default settings if file doesn't exist or is corrupt
    return {Enabled = false, ConfigName = nil}
end

local function SaveStartupSettings(data)
    pcall(function()
        writefile(StartupSettingsFile, HttpService:JSONEncode(data))
    end)
end

-- NEW: Function to apply the startup config at the beginning of the script
function lib:ApplyStartupConfig()
    local settings = LoadStartupSettings()
    if settings.Enabled and settings.ConfigName then
        -- Wait a moment for the library to be fully initialized
        wait(0.2)
        local success, msg = LoadConfig(settings.ConfigName)
        if success then
            print("Forsee: Startup config '" .. settings.ConfigName .. "' loaded successfully.")
        else
            print("Forsee: Failed to load startup config '" .. settings.ConfigName .. "'. Reason: " .. msg)
        end
    end
end


local ui = Instance.new("ScreenGui")
ui.Name = "ui"
ui.Parent = game.CoreGui
ui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local isMobile = UserInputService.TouchEnabled and not UserInputService.MouseEnabled

coroutine.wrap(function() while wait() do lib.RainbowColorValue = (lib.RainbowColorValue + 1/255) % 1 lib.HueSelectionPosition = (lib.HueSelectionPosition + 1) % 80 end end)()

local function MakeDraggable(topbar, object)
    local dragging, dragInput, dragStart, startPos
    topbar.InputBegan:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging, dragStart, startPos = true, input.Position, object.Position input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end) end end)
    topbar.InputChanged:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then dragInput = input end end)
    UserInputService.InputChanged:Connect(function(input) if input == dragInput and dragging then object.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + (input.Position.X - dragStart.X), startPos.Y.Scale, startPos.Y.Offset + (input.Position.Y - dragStart.Y)) end end)
end

local function FadeOutUI(main)
    local fadeTime = 0.3; local tweens = {}; uiElementStates = {}
    local allObjects = main:GetDescendants() table.insert(allObjects, 1, main)
    for _, obj in ipairs(allObjects) do
        if obj:IsA("GuiObject") then
            local stateToSave, propsToFade = {}, {}
            if pcall(function() return obj.BackgroundTransparency end) then stateToSave.BackgroundTransparency = obj.BackgroundTransparency; propsToFade.BackgroundTransparency = 1 end
            if pcall(function() return obj.TextTransparency end) then stateToSave.TextTransparency = obj.TextTransparency; propsToFade.TextTransparency = 1 end
            if pcall(function() return obj.ImageTransparency end) then stateToSave.ImageTransparency = obj.ImageTransparency; propsToFade.ImageTransparency = 1 end
            if obj:IsA("ScrollingFrame") then stateToSave.ScrollBarImageTransparency = obj.ScrollBarImageTransparency; obj.ScrollBarImageTransparency = 1 end
            if next(propsToFade) or stateToSave.ScrollBarImageTransparency ~= nil then uiElementStates[obj] = stateToSave if next(propsToFade) then table.insert(tweens, TweenService:Create(obj, TweenInfo.new(fadeTime, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), propsToFade)) end end
        end
    end
    for _, tween in ipairs(tweens) do tween:Play() end
    wait(fadeTime); main.Visible = false
end

local function FadeInUI(main)
    main.Visible = true; local fadeTime = 0.3; local tweens = {}
    for obj, storedState in pairs(uiElementStates) do
        if obj and obj.Parent then
            if storedState.BackgroundTransparency ~= nil then obj.BackgroundTransparency = 1 end
            if storedState.TextTransparency ~= nil then obj.TextTransparency = 1 end
            if storedState.ImageTransparency ~= nil then obj.ImageTransparency = 1 end
            if storedState.ScrollBarImageTransparency ~= nil then obj.ScrollBarImageTransparency = 1 end
            table.insert(tweens, TweenService:Create(obj, TweenInfo.new(fadeTime, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), storedState))
        end
    end
    for _, tween in ipairs(tweens) do tween:Play() end
end

function lib:Window(text, preset, closebind)
    CloseBind = closebind or Enum.KeyCode.RightControl
    PresetColor = preset or Color3.fromRGB(44, 120, 224)
    local fs = false; local MainWindow = nil; local keybindConnection = nil
    
    local Main = Instance.new("Frame", ui)
    Main.Name = "Main"; Main.AnchorPoint = Vector2.new(0.5, 0.5); Main.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Main.BorderSizePixel = 0; Main.Position = UDim2.new(0.5, 0, 0.5, 0); Main.Size = UDim2.new(0, 560, 0, 329)
    Main.ClipsDescendants = true; Main.Visible = false; Main.BackgroundTransparency = 0
    local MainCorner = Instance.new("UICorner", Main); MainCorner.CornerRadius = UDim.new(0, 8)
    
    local DragFrame = Instance.new("Frame", Main)
    DragFrame.Name = "DragFrame"; DragFrame.BackgroundTransparency = 1; DragFrame.Size = UDim2.new(0, 560, 0, 50)
    
    local Title = Instance.new("TextLabel", Main)
    Title.Name = "Title"; Title.BackgroundTransparency = 1; Title.Position = UDim2.new(0.034, 0, 0.026, 0)
    Title.Size = UDim2.new(0, 200, 0, 30); Title.Font = Enum.Font.GothamSemibold; Title.Text = text
    Title.TextColor3 = Color3.fromRGB(120, 120, 120); Title.TextSize = 14; Title.TextXAlignment = Enum.TextXAlignment.Left

    local ButtonsContainer = Instance.new("Frame", Main)
    ButtonsContainer.BackgroundTransparency = 1; ButtonsContainer.Position = UDim2.new(0.88, 0, 0.026, 0); ButtonsContainer.Size = UDim2.new(0, 70, 0, 30)

    local CloseBtn = Instance.new("TextButton", ButtonsContainer)
    CloseBtn.Name = "CloseBtn"; CloseBtn.BackgroundTransparency = 1; CloseBtn.Position = UDim2.new(0.5, 0, 0, 0)
    CloseBtn.Size = UDim2.new(0, 30, 0, 30); CloseBtn.Font = Enum.Font.GothamSemibold; CloseBtn.Text = "x"
    CloseBtn.TextColor3 = Color3.fromRGB(150, 150, 150); CloseBtn.TextSize = 16
    CloseBtn.MouseEnter:Connect(function() TweenService:Create(CloseBtn, TweenInfo.new(.2), {TextColor3 = Color3.fromRGB(255,100,100)}):Play() end)
    CloseBtn.MouseLeave:Connect(function() TweenService:Create(CloseBtn, TweenInfo.new(.2), {TextColor3 = Color3.fromRGB(150,150,150)}):Play() end)
    CloseBtn.MouseButton1Click:Connect(function() FadeOutUI(Main); wait(0.35); ui:Destroy() end)
    
    local TitleSeparator = Instance.new("Frame", Main)
    TitleSeparator.BackgroundColor3 = Color3.fromRGB(60, 60, 60); TitleSeparator.BorderSizePixel = 0
    TitleSeparator.Position = UDim2.new(0.034, 0, 0.137, 0); TitleSeparator.Size = UDim2.new(0, 520, 0, 1)

    local TabHold = Instance.new("Frame", Main)
    TabHold.Name = "TabHold"; TabHold.BackgroundTransparency = 1; TabHold.Position = UDim2.new(0.034, 0, 0.167, 0)
    TabHold.Size = UDim2.new(0, 107, 0, 254)
    local TabHoldLayout = Instance.new("UIListLayout", TabHold); TabHoldLayout.Padding = UDim.new(0, 16)
    
    local SeparatorLine = Instance.new("Frame", Main)
    SeparatorLine.BackgroundColor3 = Color3.fromRGB(60, 60, 60); SeparatorLine.BorderSizePixel = 0
    SeparatorLine.Position = UDim2.new(0.28, 0, 0.167, 0); SeparatorLine.Size = UDim2.new(0, 1, 0, 254)
    
    local TabFolder = Instance.new("Folder", Main); TabFolder.Name = "TabFolder"

    delay(0.1, function() FadeOutUI(Main); wait(0.4); uitoggled = false; FadeInUI(Main) end)
    MakeDraggable(DragFrame, Main)
    
    local function UpdateKeybindConnection()
        if keybindConnection then keybindConnection:Disconnect() end
        keybindConnection = UserInputService.InputBegan:Connect(function(io, p)
            if io.KeyCode == CloseBind and not p then
                uitoggled = not uitoggled
                if uitoggled then FadeOutUI(Main) ui.Enabled = false else FadeInUI(Main) ui.Enabled = true end
            end
        end)
    end
    UpdateKeybindConnection()
    Main.Destroying:Connect(function() if keybindConnection then keybindConnection:Disconnect() end end)

    function lib:ChangePresetColor(toch)
        PresetColor = toch
        for _, tab in pairs(TabFolder:GetChildren()) do
            for _, element in pairs(tab:GetDescendants()) do
                if element.Name == "FrameToggle3" or element.Name == "CurrentValueFrame" or element.Name == "TabBtnIndicator" or element.Name == "FrameRainbowToggle3" then element.BackgroundColor3 = toch
                elseif element.Name == "SlideCircle" then element.ImageColor3 = toch end
            end
        end
    end

    function lib:Notification(title, desc, buttons)
        -- This function remains the same as your provided version. For brevity, it is collapsed.
        if CurrentNotification then CurrentNotification:Destroy() CurrentNotification = nil end
        local NotificationHold = Instance.new("TextButton", Main) CurrentNotification = NotificationHold
        NotificationHold.BackgroundColor3 = Color3.fromRGB(0, 0, 0); NotificationHold.BackgroundTransparency = 0.7; NotificationHold.Size = UDim2.new(1, 0, 1, 0); NotificationHold.ZIndex = 10; NotificationHold.Text = ""
        local NotificationFrame = Instance.new("Frame", NotificationHold)
        NotificationFrame.AnchorPoint = Vector2.new(0.5, 0.5); NotificationFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30); NotificationFrame.ClipsDescendants = true; NotificationFrame.Position = UDim2.new(0.5, 0, 0.5, 0); NotificationFrame.Size = UDim2.new(0, 300, 0, 180); NotificationFrame.ZIndex = 11
        local NotificationCorner = Instance.new("UICorner", NotificationFrame); NotificationCorner.CornerRadius = UDim.new(0, 8)
        local NotificationTitle = Instance.new("TextLabel", NotificationFrame)
        NotificationTitle.BackgroundTransparency = 1; NotificationTitle.Position = UDim2.new(0.05, 0, 0.05, 0); NotificationTitle.Size = UDim2.new(0.9, 0, 0, 26); NotificationTitle.Font = Enum.Font.GothamBold; NotificationTitle.Text = title; NotificationTitle.TextColor3 = Color3.fromRGB(255, 255, 255); NotificationTitle.TextSize = 16; NotificationTitle.TextXAlignment = Enum.TextXAlignment.Left; NotificationTitle.ZIndex = 12
        local NotificationDesc = Instance.new("TextLabel", NotificationFrame)
        NotificationDesc.BackgroundTransparency = 1; NotificationDesc.Position = UDim2.new(0.05, 0, 0.2, 0); NotificationDesc.Size = UDim2.new(0.9, 0, 0, 70); NotificationDesc.Font = Enum.Font.Gotham; NotificationDesc.Text = desc; NotificationDesc.TextColor3 = Color3.fromRGB(200, 200, 200); NotificationDesc.TextSize = 14; NotificationDesc.TextWrapped = true; NotificationDesc.TextXAlignment = Enum.TextXAlignment.Left; NotificationDesc.TextYAlignment = Enum.TextYAlignment.Top; NotificationDesc.ZIndex = 12
        local ButtonContainer = Instance.new("Frame", NotificationFrame); ButtonContainer.BackgroundTransparency = 1; ButtonContainer.Position = UDim2.new(0.05, 0, 0.65, 0); ButtonContainer.Size = UDim2.new(0.9, 0, 0, 50); ButtonContainer.ZIndex = 12
        local ButtonLayout = Instance.new("UIListLayout", ButtonContainer); ButtonLayout.FillDirection = Enum.FillDirection.Horizontal; ButtonLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center; ButtonLayout.Padding = UDim.new(0, 10)
        local function CloseNotification() if NotificationHold and NotificationHold.Parent then NotificationHold:Destroy() end CurrentNotification = nil end
        if type(buttons) == "string" then
            local Btn = Instance.new("TextButton", ButtonContainer); Btn.BackgroundColor3 = Color3.fromRGB(34,34,34); Btn.Size = UDim2.new(0,120,0,35); Btn.Font=Enum.Font.Gotham; Btn.Text=buttons; Btn.TextColor3=Color3.fromRGB(255,255,255); Btn.TextSize=14
            Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 6)
            Btn.MouseButton1Click:Connect(CloseNotification)
        elseif type(buttons) == "table" then
            for _, btnData in ipairs(buttons) do
                local Btn = Instance.new("TextButton", ButtonContainer); Btn.BackgroundColor3 = btnData.Color or Color3.fromRGB(34,34,34); Btn.Size = UDim2.new(0,120,0,35); Btn.Font=Enum.Font.Gotham; Btn.Text=btnData.Text; Btn.TextColor3=Color3.fromRGB(255,255,255); Btn.TextSize=14
                Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 6)
                Btn.MouseButton1Click:Connect(function() if btnData.Callback then pcall(btnData.Callback) end CloseNotification() end)
            end
        end
    end

    function lib:ConfigTab(tab)
        local selectedConfig = ""; local configDropdown
        tab:Textbox("New Config Name", false, function(text) CurrentConfigName = text end)
        tab:Button("Save Config", function()
            if CurrentConfigName and CurrentConfigName ~= "" then
                local s, m = SaveConfig(CurrentConfigName) lib:Notification(s and "Success" or "Error", m, "Okay")
                if s and configDropdown then wait(0.1) configDropdown.Refresh() end
            else lib:Notification("Error", "Please enter a config name first", "Okay") end
        end)
        tab:Label("Load/Delete Configs")
        configDropdown = tab:Dropdown("Select Config", GetAllConfigs, function(selected) selectedConfig = selected end)
        tab:Button("Load Config", function() if selectedConfig and selectedConfig ~= "No Configs" then local s, m = LoadConfig(selectedConfig) lib:Notification(s and "Success" or "Error", m, "Okay") else lib:Notification("Error", "Select a config first", "Okay") end end)
        tab:Button("Delete Config", function()
            if selectedConfig and selectedConfig ~= "No Configs" then
                lib:Notification("Confirm Deletion", "Delete '" .. selectedConfig .. "'?", {{Text = "Cancel"},{Text = "Delete", Color = Color3.fromRGB(200, 50, 50), Callback = function()
                    local s, m = DeleteConfig(selectedConfig) wait(0.2) lib:Notification(s and "Success" or "Error", m, "Okay")
                    if s and configDropdown then wait(0.1) configDropdown.Refresh() selectedConfig = "" end
                end}})
            else lib:Notification("Error", "Select a config first", "Okay") end
        end)
    end
    
    -- NEW: Function to create the Startup Config section
    function lib:StartupConfigTab(tab)
        local startupSettings = LoadStartupSettings()

        local function updateAndSave()
            SaveStartupSettings(startupSettings)
        end

        tab:Toggle("Enable Startup Config", startupSettings.Enabled, function(state)
            startupSettings.Enabled = state
            updateAndSave()
        end)

        local startupDropdown = tab:Dropdown("Startup Config", GetAllConfigs, function(selected)
            if selected ~= "No Configs" then
                startupSettings.ConfigName = selected
                updateAndSave()
            end
        end)
        
        -- Set initial text for dropdown if a config was loaded
        if startupSettings.ConfigName then
            startupDropdown.SetText("Startup Config - " .. startupSettings.ConfigName)
        end
    end

    function lib:SetToggleKey(key) CloseBind = key; UpdateKeybindConnection(); lib:Notification("Keybind Updated", "UI toggle key set to: " .. key.Name, "Okay") end
    function lib:GetToggleKey() return CloseBind end

    local tabhold = {}
    function tabhold:Tab(text)
        local TabBtn = Instance.new("TextButton", TabHold); TabBtn.Name = "TabBtn"; TabBtn.BackgroundTransparency = 1; TabBtn.Size = UDim2.new(0, 107, 0, 28); TabBtn.Text = ""
        local TabTitle = Instance.new("TextLabel", TabBtn); TabTitle.Name = "TabTitle"; TabTitle.BackgroundTransparency = 1; TabTitle.Size = UDim2.new(1, 0, 1, 0); TabTitle.Font = Enum.Font.Gotham; TabTitle.Text = text; TabTitle.TextColor3 = Color3.fromRGB(150, 150, 150); TabTitle.TextSize = 14; TabTitle.TextXAlignment = Enum.TextXAlignment.Left
        local TabBtnIndicator = Instance.new("Frame", TabBtn); TabBtnIndicator.Name = "TabBtnIndicator"; TabBtnIndicator.BackgroundColor3 = PresetColor; TabBtnIndicator.BorderSizePixel = 0; TabBtnIndicator.Position = UDim2.new(0, 0, 1, 0); TabBtnIndicator.Size = UDim2.new(0, 0, 0, 2)
        Instance.new("UICorner", TabBtnIndicator)
        
        local Tab = Instance.new("ScrollingFrame", TabFolder); Tab.Name = "Tab"; Tab.Active = true; Tab.BackgroundTransparency = 1; Tab.BorderSizePixel = 0; Tab.Position = UDim2.new(0.314, 0, 0.167, 0); Tab.Size = UDim2.new(0, 373, 0, 254); Tab.CanvasSize = UDim2.new(0, 0, 0, 0); Tab.ScrollBarThickness = 3; Tab.Visible = false
        local TabLayout = Instance.new("UIListLayout", Tab); TabLayout.Padding = UDim.new(0, 6)

        if not fs then fs = true; TabBtnIndicator.Size = UDim2.new(0, #text * 8.5, 0, 2); TabTitle.TextColor3 = Color3.fromRGB(255, 255, 255); Tab.Visible = true end

        TabBtn.MouseButton1Click:Connect(function()
            for _, v in pairs(TabFolder:GetChildren()) do v.Visible = false end; Tab.Visible = true
            for _, v in pairs(TabHold:GetChildren()) do if v.Name == "TabBtn" then v.TabBtnIndicator:TweenSize(UDim2.new(0, 0, 0, 2), "Out", "Quart", 0.2, true); TweenService:Create(v.TabTitle, TweenInfo.new(0.3), {TextColor3 = Color3.fromRGB(150, 150, 150)}):Play() end end
            TabBtnIndicator:TweenSize(UDim2.new(0, #text * 8.5, 0, 2), "Out", "Quart", 0.2, true); TweenService:Create(TabTitle, TweenInfo.new(0.3), {TextColor3 = Color3.fromRGB(255, 255, 255)}):Play()
        end)
        
        local tabcontent = {}
.
        
        function tabcontent:Button(text, cb) local B = Instance.new("TextButton",Tab);B.Name="Button";B.BackgroundColor3=Color3.fromRGB(34,34,34);B.Size=UDim2.new(0,363,0,42);B.AutoButtonColor=false;B.Text="";local C=Instance.new("UICorner",B);C.CornerRadius=UDim.new(0,6);local T=Instance.new("TextLabel",B);T.Name="ButtonTitle";T.BackgroundTransparency=1;T.Position=UDim2.new(0.035,0,0,0);T.Size=UDim2.new(0,187,0,42);T.Font=Enum.Font.Gotham;T.Text=text;T.TextColor3=Color3.fromRGB(255,255,255);T.TextSize=14;T.TextXAlignment=Enum.TextXAlignment.Left;B.MouseEnter:Connect(function()TweenService:Create(B,TweenInfo.new(.2),{BackgroundColor3=Color3.fromRGB(37,37,37)}):Play()end);B.MouseLeave:Connect(function()TweenService:Create(B,TweenInfo.new(.2),{BackgroundColor3=Color3.fromRGB(34,34,34)}):Play()end);B.MouseButton1Click:Connect(function()pcall(cb)end);Tab.CanvasSize=UDim2.new(0,0,0,TabLayout.AbsoluteContentSize.Y)end
        function tabcontent:Toggle(text,default,cb) globalElementIdCounter=globalElementIdCounter+1;local id="Toggle_"..globalElementIdCounter;local t=default or false;local E=Instance.new("TextButton",Tab);E.Name="Toggle";E.BackgroundColor3=Color3.fromRGB(34,34,34);E.Size=UDim2.new(0,363,0,42);E.Text="";Instance.new("UICorner",E).CornerRadius=UDim.new(0,6);local T=Instance.new("TextLabel",E);T.BackgroundTransparency=1;T.Position=UDim2.new(0.035,0,0,0);T.Size=UDim2.new(0,187,0,42);T.Font=Enum.Font.Gotham;T.Text=text;T.TextColor3=Color3.fromRGB(255,255,255);T.TextSize=14;T.TextXAlignment=Enum.TextXAlignment.Left;local F1=Instance.new("Frame",E);F1.Name="FrameToggle1";F1.BackgroundColor3=Color3.fromRGB(50,50,50);F1.Position=UDim2.new(0.86,0,0.28,0);F1.Size=UDim2.new(0,37,0,18);Instance.new("UICorner",F1).CornerRadius=UDim.new(0,6);local F3=Instance.new("Frame",F1);F3.Name="FrameToggle3";F3.BackgroundColor3=PresetColor;F3.BackgroundTransparency=1;F3.Size=UDim2.new(0,37,0,18);Instance.new("UICorner",F3).CornerRadius=UDim.new(0,6);local C=Instance.new("Frame",F1);C.Name="FrameToggleCircle";C.BackgroundColor3=Color3.fromRGB(50,50,50);C.Position=UDim2.new(0.127,0,0.222,0);C.Size=UDim2.new(0,10,0,10);Instance.new("UICorner",C).CornerRadius=UDim.new(0,5);local function s(v)t=v;if v then F3.BackgroundTransparency=0;C.BackgroundColor3=Color3.fromRGB(255,255,255);C.Position=UDim2.new(0.587,0,0.222,0)else F3.BackgroundTransparency=1;C.BackgroundColor3=Color3.fromRGB(50,50,50);C.Position=UDim2.new(0.127,0,0.222,0)end;pcall(cb,v)end;ConfigElements[id]={Type="Toggle",Value=t,LoadValue=s};E.MouseButton1Click:Connect(function()s(not t)end);s(t);Tab.CanvasSize=UDim2.new(0,0,0,TabLayout.AbsoluteContentSize.Y)end
        function tabcontent:Slider(text,min,max,start,cb) globalElementIdCounter=globalElementIdCounter+1;local id="Slider_"..globalElementIdCounter;local v=start or 0;local S=Instance.new("TextButton",Tab);S.Name="Slider";S.BackgroundColor3=Color3.fromRGB(34,34,34);S.Size=UDim2.new(0,363,0,60);S.Text="";Instance.new("UICorner",S).CornerRadius=UDim.new(0,6);local T=Instance.new("TextLabel",S);T.BackgroundTransparency=1;T.Position=UDim2.new(0.035,0,0,0);T.Size=UDim2.new(0,187,0,42);T.Font=Enum.Font.Gotham;T.Text=text;T.TextColor3=Color3.fromRGB(255,255,255);T.TextSize=14;T.TextXAlignment=Enum.TextXAlignment.Left;local V=Instance.new("TextLabel",S);V.BackgroundTransparency=1;V.Size=UDim2.new(1,-20,1,0);V.Font=Enum.Font.Gotham;V.TextColor3=Color3.fromRGB(255,255,255);V.TextSize=14;V.TextXAlignment=Enum.TextXAlignment.Right;local F=Instance.new("Frame",S);F.BackgroundColor3=Color3.fromRGB(50,50,50);F.Position=UDim2.new(0.034,0,0.686,0);F.Size=UDim2.new(0,335,0,3);Instance.new("UICorner",F).CornerRadius=UDim.new(1,0);local CF=Instance.new("Frame",F);CF.Name="CurrentValueFrame";CF.BackgroundColor3=PresetColor;CF.Size=UDim2.new(0,0,1,0);Instance.new("UICorner",CF).CornerRadius=UDim.new(1,0);local C=Instance.new("ImageButton",F);C.Name="SlideCircle";C.BackgroundTransparency=1;C.Size=UDim2.new(0,11,0,11);C.Image="rbxassetid://3570695787";C.ImageColor3=PresetColor;local function set(val)v=val;local p=math.clamp((v-min)/(max-min),0,1);V.Text=tostring(math.floor(v));CF.Size=UDim2.new(p,0,1,0);C.Position=UDim2.new(p,-6,-1.3,0);ConfigElements[id].Value=v;pcall(cb,v)end;local dr=false;C.InputBegan:Connect(function(i)if i.UserInputType==Enum.UserInputType.MouseButton1 then dr=true end end);C.InputEnded:Connect(function(i)if i.UserInputType==Enum.UserInputType.MouseButton1 then dr=false end end);UserInputService.InputChanged:Connect(function(i)if dr and i.UserInputType==Enum.UserInputType.MouseMovement then local p=math.clamp((i.Position.X-F.AbsolutePosition.X)/F.AbsoluteSize.X,0,1);local nV=math.floor(min+(max-min)*p);set(nV)end end);ConfigElements[id]={Type="Slider",Value=v,LoadValue=set};set(v);Tab.CanvasSize=UDim2.new(0,0,0,TabLayout.AbsoluteContentSize.Y)end
        function tabcontent:Dropdown(text,listOrFunc,cb) globalElementIdCounter=globalElementIdCounter+1;local id="Dropdown_"..globalElementIdCounter;local tg,fs,ic,val=false,0,0,nil;local D=Instance.new("Frame",Tab);D.BackgroundColor3=Color3.fromRGB(34,34,34);D.ClipsDescendants=true;D.Size=UDim2.new(0,363,0,42);Instance.new("UICorner",D).CornerRadius=UDim.new(0,6);local B=Instance.new("TextButton",D);B.BackgroundTransparency=1;B.Size=UDim2.new(1,0,1,0);B.Text="";local T=Instance.new("TextLabel",D);T.Name=text;T.BackgroundTransparency=1;T.Position=UDim2.new(0.035,0,0,0);T.Size=UDim2.new(0,300,0,42);T.Font=Enum.Font.Gotham;T.Text=text;T.TextColor3=Color3.fromRGB(255,255,255);T.TextSize=14;T.TextXAlignment=Enum.TextXAlignment.Left;local A=Instance.new("ImageLabel",D);A.BackgroundTransparency=1;A.Position=UDim2.new(1,-36,0.5,-13);A.Size=UDim2.new(0,26,0,26);A.Image="http://www.roblox.com/asset/?id=6034818375";local IH=Instance.new("ScrollingFrame",D);IH.Active=true;IH.BackgroundTransparency=1;IH.BorderSizePixel=0;IH.Position=UDim2.new(0.04,0,1.1,0);IH.Size=UDim2.new(0.92,0,0,0);IH.CanvasSize=UDim2.new(0,0,0,0);IH.ScrollBarThickness=3;local IL=Instance.new("UIListLayout",IH);IL.Padding=UDim.new(0,2);local o={};function o.SetText(newText) T.Text=newText end;function o.Refresh()if type(listOrFunc)=="function" then local l=listOrFunc();for _,c in pairs(IH:GetChildren())do if c:IsA("TextButton")then c:Destroy()end end;fs,ic=0,0;for _,v in pairs(l)do ic=ic+1;if ic<=3 then fs=fs+26;IH.Size=UDim2.new(0.92,0,0,fs)end;local I=Instance.new("TextButton",IH);I.BackgroundColor3=Color3.fromRGB(34,34,34);I.Size=UDim2.new(1,0,0,25);I.Font=Enum.Font.Gotham;I.Text=v;I.TextColor3=Color3.fromRGB(255,255,255);I.TextSize=15;Instance.new("UICorner",I).CornerRadius=UDim.new(0,6);I.MouseButton1Click:Connect(function()tg=not tg;T.Text=text.." - "..v;val=v;ConfigElements[id].Value=v;pcall(cb,v);D:TweenSize(UDim2.new(0,363,0,42),"Out","Quart",.2,true);A:TweenRotation(0,"Out","Quart",.2,true);wait(.2);Tab.CanvasSize=UDim2.new(0,0,0,TabLayout.AbsoluteContentSize.Y)end)end;IH.CanvasSize=UDim2.new(0,0,0,IL.AbsoluteContentSize.Y)end end;B.MouseButton1Click:Connect(function()if not tg then o.Refresh() D:TweenSize(UDim2.new(0,363,0,55+fs),"Out","Quart",.2,true);A:TweenRotation(270,"Out","Quart",.2,true);wait(.2)else D:TweenSize(UDim2.new(0,363,0,42),"Out","Quart",.2,true);A:TweenRotation(0,"Out","Quart",.2,true);wait(.2)end;tg=not tg;Tab.CanvasSize=UDim2.new(0,0,0,TabLayout.AbsoluteContentSize.Y)end);ConfigElements[id]={Type="Dropdown",Value=val,LoadValue=function(v)val=v;T.Text=text.." - "..tostring(v);pcall(cb,v)end};o.Refresh();Tab.CanvasSize=UDim2.new(0,0,0,TabLayout.AbsoluteContentSize.Y);return o end
        function tabcontent:Label(text) local L=Instance.new("TextLabel",Tab);L.BackgroundColor3=Color3.fromRGB(26,26,26);L.Size=UDim2.new(0,363,0,42);L.Font=Enum.Font.Gotham;L.Text="  "..text;L.TextColor3=Color3.fromRGB(255,255,255);L.TextSize=14;L.TextXAlignment=Enum.TextXAlignment.Left;Instance.new("UICorner",L).CornerRadius=UDim.new(0,6);Tab.CanvasSize=UDim2.new(0,0,0,TabLayout.AbsoluteContentSize.Y)end
        function tabcontent:Textbox(text,dis,cb) globalElementIdCounter=globalElementIdCounter+1;local id="Textbox_"..globalElementIdCounter;local v="";local F=Instance.new("Frame",Tab);F.BackgroundColor3=Color3.fromRGB(34,34,34);F.Size=UDim2.new(0,363,0,42);Instance.new("UICorner",F).CornerRadius=UDim.new(0,6);local T=Instance.new("TextLabel",F);T.BackgroundTransparency=1;T.Size=UDim2.new(0.5,0,1,0);T.Position=UDim2.new(0.035,0,0,0);T.Font=Enum.Font.Gotham;T.Text=text;T.TextColor3=Color3.fromRGB(255,255,255);T.TextSize=14;T.TextXAlignment=Enum.TextXAlignment.Left;local TF=Instance.new("Frame",F);TF.BackgroundColor3=Color3.fromRGB(37,37,37);TF.Position=UDim2.new(1,-110,0.5,-11.5);TF.Size=UDim2.new(0,100,0,23);Instance.new("UICorner",TF).CornerRadius=UDim.new(0,6);local B=Instance.new("TextBox",TF);B.BackgroundTransparency=1;B.Size=UDim2.new(1,0,1,0);B.Font=Enum.Font.Gotham;B.Text="";B.TextColor3=Color3.fromRGB(255,255,255);B.TextSize=14;ConfigElements[id]={Type="Textbox",Value=v,LoadValue=function(val)v=val or"";B.Text=v;pcall(cb,v)end};B:GetPropertyChangedSignal("Text"):Connect(function()v=B.Text;ConfigElements[id].Value=v;pcall(cb,v)end);B.FocusLost:Connect(function(e)if e and dis then B.Text=""v="";ConfigElements[id].Value=""end end);Tab.CanvasSize=UDim2.new(0,0,0,TabLayout.AbsoluteContentSize.Y)end
        function tabcontent:Bind(text,key,cb) globalElementIdCounter=globalElementIdCounter+1;local id="Bind_"..globalElementIdCounter;local k,b=key,false;local B=Instance.new("TextButton",Tab);B.BackgroundColor3=Color3.fromRGB(34,34,34);B.Size=UDim2.new(0,363,0,42);Instance.new("UICorner",B).CornerRadius=UDim.new(0,6);local T=Instance.new("TextLabel",B);T.BackgroundTransparency=1;T.Size=UDim2.new(0.5,0,1,0);T.Position=UDim2.new(0.035,0,0,0);T.Font=Enum.Font.Gotham;T.Text=text;T.TextColor3=Color3.fromRGB(255,255,255);T.TextSize=14;T.TextXAlignment=Enum.TextXAlignment.Left;local KT=Instance.new("TextLabel",B);KT.BackgroundTransparency=1;KT.Size=UDim2.new(1,-20,1,0);KT.Font=Enum.Font.Gotham;KT.TextColor3=Color3.fromRGB(255,255,255);KT.TextSize=14;KT.TextXAlignment=Enum.TextXAlignment.Right;ConfigElements[id]={Type="Bind",Value=k.Name,LoadValue=function(v)for _,kc in pairs(Enum.KeyCode:GetEnumItems())do if kc.Name==v then k=kc;KT.Text=k.Name;break end end end};B.MouseButton1Click:Connect(function()if isMobile then return end;KT.Text="...";b=true;local i=UserInputService.InputBegan:wait();if i.KeyCode.Name~="Unknown"then k=i.KeyCode;ConfigElements[id].Value=k.Name;if text:lower():find"toggle"then lib:SetToggleKey(k)end;pcall(cb)end;KT.Text=k.Name;b=false end);UserInputService.InputBegan:Connect(function(i,p)if not p and i.KeyCode==k and not b then pcall(cb)end end);KT.Text=k.Name;Tab.CanvasSize=UDim2.new(0,0,0,TabLayout.AbsoluteContentSize.Y)end

        return tabcontent
    end
    return tabhold
end

return lib
